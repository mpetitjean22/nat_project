package main

import (
	"fmt"
	"nat_project/pkg/nat"
)

/* Driver for NAT Stuff, if needed */
func main() {
	nat.AddMapping([4]byte{0x01, 0x01, 0x01, 0x01}, [2]byte{0x00, 0x80}, [4]byte{0x02, 0x02, 0x02, 0x02}, [2]byte{0x00, 0x70})
	nat.AddMapping([4]byte{0x01, 0x01, 0x01, 0x01}, [2]byte{0x00, 0x80}, [4]byte{0x02, 0x02, 0x02, 0x02}, [2]byte{0x00, 0x50})
	nat.AddMapping([4]byte{0x03, 0x03, 0x03, 0x03}, [2]byte{0x00, 0x80}, [4]byte{0x04, 0x04, 0x04, 0x04}, [2]byte{0x00, 0x80})
	nat.AddMapping([4]byte{0x03, 0x03, 0x03, 0x03}, [2]byte{0x00, 0x50}, [4]byte{0x04, 0x04, 0x04, 0x04}, [2]byte{0x00, 0x50})

	mappings := nat.ListMappings()
	for key, value := range mappings {
		fmt.Printf("%v to %v \n", key, *value)
	}

	dstIP, dstPort, err := nat.GetMapping([4]byte{0x01, 0x01, 0x01, 0x01}, [2]byte{0x00, 0x80})
	if err != nil {
		fmt.Println("error")
		return
	}
	fmt.Printf("%v %v \n", dstIP, dstPort)
}
